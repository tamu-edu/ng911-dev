<?xml version="1.0" encoding="ISO-8859-1" ?>
<scenario name="SIP_SUBSCRIBE_civic_address_filter_with_NOTIFY_receive">
  <send>
    <![CDATA[

      SUBSCRIBE sip:[service]@[remote_ip]:[remote_port] SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port]
      To: <sip:[service]@[remote_ip]:[remote_port]>
      From: SENDER <sip:SENDER@[local_ip]:[local_port]>;tag=[call_number]
      Call-ID: [call_id]
      CSeq: 1 SUBSCRIBE
      Max-Forwards: 70
      Event: presence
      Accept: application/pidf+xml
      Contact: sip:SENDER@[local_ip]:[local_port]
      Expires: 600
      Content-Type: application/pidf+xml
      Content-Length: [len]

      <?xml version="1.0" encoding="UTF-8"?>
        <filter-set xmlns="urn:ietf:params:xml:ns:simple-filter">
          <ns-bindings>
            <ns-binding prefix="ca"
               urn="urn:ietf:params:xml:ns:pidf:geopriv10:civicAddr"/>
          </ns-bindings>
          <filter id="123" uri="sip:presentity@example.com">
              <trigger>
                  <changed>//ca:country</changed>
              </trigger>
              <trigger>
                  <changed>//ca:A1</changed>
              </trigger>
              <trigger>
                  <changed>//ca:A2</changed>
              </trigger>
              <trigger>
                  <changed>//ca:A3</changed>
              </trigger>
              <trigger>
                  <changed>//ca:PC</changed>
              </trigger>
          </filter>
        </filter-set>

    ]]>
  </send>
  
  <recv response="NOTIFY" optional="true" next="1"> </recv>
  
  <recv response="200"></recv>

  <label id="2"/>
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>  
  <recv request="NOTIFY"> </recv>
  <send>
    <![CDATA[
  
      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: sip:SENDER@[local_ip]:[local_port]
      Content-Length: [len]
    
    ]]>
  </send>

  <label id="1"/>
  <send next="2">
      <![CDATA[
  
        SIP/2.0 200 OK
        [last_Via:]
        [last_From:]
        [last_To:];tag=[call_number]
        [last_Call-ID:]
        [last_CSeq:]
        Contact: sip:SENDER@[local_ip]:[local_port]
        Content-Length: [len]
    
      ]]>
  </send>
</scenario>
